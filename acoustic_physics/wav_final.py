import matplotlib.pyplot as plt
import numpy as np
import wave
import sys
from scipy.io.wavfile import read
import math
from scipy import optimize

#fs, data = wavfile.read('test.wav')
#200000

'''
a = wave.open('test.wav', 'r')
signal = a.readframes(-1)
signal = np.fromstring(signal, 'Int16')
fs = a.getframerate()
Time = np.linspace(0, len(signal)/fs, num=len(signal))
plt.figure(1)
plt.title("Graph 1")
plt.plot(Time, signal)
plt.show()
'''

#Silver

ds = 0

def read_file(name, spacing, num_x, colour, factor):
    input_data = read(name)
    audio = input_data[1]

    processed_data = []
    max_value = []
    for k in range(0, len(audio)):
        if (factor == "+"):
            if (audio[k][0] >= 0):
                max_value.append(audio[k][0])
                processed_data.append(audio[k])
        if (factor == "-"):
            if (audio[k][0] <= 0):
                max_value.append(audio[k][0])
                processed_data.append(audio[k])



    if (factor == "+"):
        max_arg = num_x+max_value.index(max(max_value))+ds
    if (factor == "-"):
        max_arg = num_x+max_value.index(min(max_value))+ds
    sampling_size = math.floor(num_x/spacing)
    #The value of 2000 spacing was determined through visual inspection of the data

    peak_data = []
    position_data = []

    for i in range (1, int(sampling_size)):
        if (factor == "+"):
            processed_max = max_value[(max_value.index(max(max_value))+ds):max_arg]
            peak = max(processed_max[spacing*(i-1):spacing*i])
            otherposition = processed_max[spacing*(i-1):spacing*i].index(max(processed_max[spacing*(i-1):spacing*i]))
        if (factor == "-"):
            processed_max = max_value[(max_value.index(min(max_value))+ds):max_arg]
            otherposition = processed_max[spacing*(i-1):spacing*i].index(min(processed_max[spacing*(i-1):spacing*i]))
            peak = min(processed_max[spacing*(i-1):spacing*i])
        position = max_value.index(peak)
        position_data.append(otherposition+(spacing*(i-1)))
        peak_data.append(processed_data[position])

    scatter = []
    scatterpos = []
    for g in peak_data:
        scatter.append(g[0])
    for g in position_data:
        scatterpos.append(g)


    #print(peak_data)
    #print(position_data)

    plt.plot(processed_data[(max_value.index(max(max_value))+ds):max_arg], zorder=0)
    plt.plot(position_data, peak_data, zorder=5, c=colour)

    #plt.scatter(position_data, scatter)

    return [scatter, scatterpos]

#print(read_file('./Physics/brasstest.wav', 1000, 100000, 'g', '+'))
#print(read_file('./Physics/silverfinal.wav', 1000, 100000, 'r', '+'))


'''
xc = read_file('./Physics/brasstest.wav', 1000, 100000, 'r', '+')
for t in range(0, len(xc[0])):
    print(xc[0][t])
print(" ")
print(" ")
for t in range(0, len(xc[1])):
    print(xc[1][t])
'''


colour_array = ['red', 'black', 'purple', 'green', 'silver']
other = 'brass'
final_colour = ['brass', 'red', 'black', 'purple', 'green', 'silver']
average = []
averagepos = []
holder = []
holderpos = []



#read_file('./Physics/red1.wav', 1000, 100000, 'r')
#read_file('./Physics/red1.wav', 2000, 100000, 'b')
#read_file('./Physics/red1.wav', 500, 100000, 'g')
def ops():
    for b in range (1, 6):
        holder.append(read_file('./Physics2/'+other+str(b)+'.wav', 1000, 100000, 'r', "+")[0])
        holderpos.append(read_file('./Physics2/'+other+str(b)+'.wav', 1000, 100000, 'r', "+")[1])
        #print(len(read_file('./Physics/'+other+str(b)+'.wav', 1000, 100000, 'r')))

    final_holder = []
    final_holder_pos = []
    for r in range (0, len(holder[0])):
        sum = 0
        sumpos = 0
        for o in range(0, 5):
            sum = sum + holder[o][r]
            sumpos = sumpos + holderpos[o][r]
        final_holder.append(sum/5)
        final_holder_pos.append(sumpos/5)
    average.append(final_holder)
    averagepos.append(final_holder_pos)

    holder = []
    holderpos = []
    for t in colour_array:
        h = []
        hpos = []
        for b in range (1, 6):
            h.append(read_file('./Physics2/'+t+str(b)+'.wav', 1000, 100000, 'r', "+")[0])
            hpos.append(read_file('./Physics2/'+t+str(b)+'.wav', 1000, 100000, 'r', "+")[1])
        holder.append(h)
        holderpos.append(hpos)

    for v in range (0, len(holder)):
        final_holder = []
        final_holder_pos = []
        for r in range (0, len(holder[v][0])):
            sum = 0
            sumpos = 0
            for o in range(0, 5):
                sum = sum + holder[v][o][r]
                sumpos = sumpos + holderpos[v][o][r]
            final_holder.append(sum/5)
            final_holder_pos.append(sumpos/5)
        average.append(final_holder)
        averagepos.append(final_holder_pos)

    print(average)
    print(averagepos)



average = [[9508.6, 5658.4, 5214.6, 4067.4, 3061.2, 2977.8, 2918.6, 2691.2, 2776.0, 2137.6, 2048.2, 1701.6, 1435.2, 1419.4, 1028.6, 969.8, 828.6, 596.4, 436.8, 359.6, 346.0, 347.0, 407.4, 394.6, 341.4, 283.0, 224.8, 282.2, 243.4, 286.4, 266.4, 200.2, 177.8, 186.4, 223.8, 229.2, 244.6, 205.0, 204.2, 188.6, 194.0, 178.8, 222.0, 175.6, 212.0, 185.8, 207.6, 166.0, 160.8, 181.6, 189.2, 196.0, 181.4, 153.0, 129.0, 152.2, 188.2, 170.0, 168.4, 183.4, 194.4, 190.8, 203.4, 237.0, 204.0, 237.8, 253.0, 251.4, 191.8, 231.8, 227.0, 222.8, 259.6, 216.6, 176.6, 209.4, 183.4, 209.2, 231.0, 255.2, 279.4, 268.6, 190.8, 218.0, 211.8, 199.2, 253.2, 202.6, 207.2, 241.0, 185.6, 168.6, 169.8, 187.8, 209.2, 177.4, 228.4, 190.2, 173.0], [16788.833333333332, 8497.333333333334, 5442.333333333333, 2694.5, 1591.6666666666667, 1486.8333333333333, 1333.3333333333333, 1282.3333333333333, 1281.3333333333333, 954.1666666666666, 1101.6666666666667, 892.3333333333334, 769.3333333333334, 514.8333333333334, 584.0, 533.3333333333334, 521.6666666666666, 463.6666666666667, 446.6666666666667, 801.5, 738.6666666666666, 515.5, 490.5, 450.6666666666667, 363.0, 376.0, 429.5, 397.1666666666667, 344.5, 362.8333333333333, 409.6666666666667, 428.1666666666667, 378.8333333333333, 352.1666666666667, 375.3333333333333, 373.5, 308.0, 377.0, 376.5, 274.1666666666667, 301.0, 285.0, 412.1666666666667, 391.1666666666667, 368.1666666666667, 359.1666666666667, 345.8333333333333, 244.33333333333334, 315.3333333333333, 272.0, 262.5, 267.1666666666667, 229.16666666666666, 250.66666666666666, 353.3333333333333, 262.6666666666667, 235.33333333333334, 234.83333333333334, 228.5, 208.5, 230.5, 281.8333333333333, 241.33333333333334, 257.8333333333333, 259.3333333333333, 290.6666666666667, 330.3333333333333, 339.8333333333333, 281.3333333333333, 224.83333333333334, 213.83333333333334, 248.16666666666666, 239.33333333333334, 279.1666666666667, 261.6666666666667, 218.5, 173.0, 278.0, 358.3333333333333, 269.6666666666667, 332.5, 211.33333333333334, 241.83333333333334, 236.5, 235.0, 239.5, 183.16666666666666, 238.0, 212.33333333333334, 219.66666666666666, 224.16666666666666, 199.83333333333334, 212.5, 197.66666666666666, 175.66666666666666, 249.33333333333334, 217.66666666666666, 208.0, 183.66666666666666], [17083.333333333332, 5804.5, 7363.833333333333, 7127.5, 4784.5, 3038.5, 2550.5, 2002.8333333333333, 1784.3333333333333, 1829.5, 1454.0, 1227.8333333333333, 1114.3333333333333, 1000.0, 888.6666666666666, 854.1666666666666, 762.5, 731.6666666666666, 643.0, 644.0, 609.6666666666666, 647.1666666666666, 531.1666666666666, 531.1666666666666, 452.6666666666667, 457.3333333333333, 482.8333333333333, 413.5, 377.5, 415.1666666666667, 402.6666666666667, 395.6666666666667, 403.3333333333333, 353.3333333333333, 366.0, 366.3333333333333, 407.3333333333333, 331.8333333333333, 305.8333333333333, 320.8333333333333, 250.66666666666666, 288.1666666666667, 303.6666666666667, 249.83333333333334, 309.3333333333333, 282.3333333333333, 231.0, 259.6666666666667, 227.0, 221.66666666666666, 220.0, 252.5, 268.1666666666667, 253.83333333333334, 185.83333333333334, 262.1666666666667, 240.16666666666666, 268.5, 268.0, 220.66666666666666, 237.33333333333334, 201.16666666666666, 269.1666666666667, 242.66666666666666, 244.66666666666666, 242.33333333333334, 226.66666666666666, 299.0, 240.0, 223.66666666666666, 254.0, 239.16666666666666, 225.66666666666666, 239.33333333333334, 218.16666666666666, 216.66666666666666, 253.33333333333334, 223.33333333333334, 204.33333333333334, 236.16666666666666, 238.5, 247.16666666666666, 224.33333333333334, 239.16666666666666, 244.83333333333334, 259.6666666666667, 241.33333333333334, 299.6666666666667, 225.16666666666666, 259.5, 263.0, 238.5, 235.66666666666666, 217.83333333333334, 246.16666666666666, 230.0, 202.83333333333334, 237.0, 228.83333333333334], [23885.5, 8563.833333333334, 6189.833333333333, 4566.5, 3138.6666666666665, 2817.1666666666665, 2376.6666666666665, 2061.6666666666665, 1800.5, 1326.0, 1355.3333333333333, 1145.0, 1082.3333333333333, 846.6666666666666, 949.8333333333334, 745.6666666666666, 676.3333333333334, 605.3333333333334, 512.1666666666666, 582.3333333333334, 424.8333333333333, 470.5, 355.3333333333333, 389.0, 394.1666666666667, 403.0, 372.3333333333333, 323.6666666666667, 380.0, 324.5, 274.8333333333333, 321.5, 235.33333333333334, 273.1666666666667, 258.8333333333333, 219.5, 240.83333333333334, 215.66666666666666, 253.0, 296.1666666666667, 193.83333333333334, 259.6666666666667, 224.0, 237.83333333333334, 188.0, 244.0, 207.33333333333334, 210.5, 245.16666666666666, 223.83333333333334, 268.5, 254.66666666666666, 249.83333333333334, 228.33333333333334, 179.16666666666666, 245.83333333333334, 275.5, 245.0, 181.33333333333334, 181.33333333333334, 150.33333333333334, 190.5, 204.83333333333334, 163.66666666666666, 219.16666666666666, 236.83333333333334, 199.83333333333334, 225.66666666666666, 263.5, 251.5, 235.33333333333334, 192.16666666666666, 224.5, 227.83333333333334, 196.33333333333334, 222.33333333333334, 211.66666666666666, 216.16666666666666, 195.33333333333334, 186.16666666666666, 243.66666666666666, 176.83333333333334, 203.5, 199.33333333333334, 194.5, 199.16666666666666, 188.66666666666666, 162.16666666666666, 198.5, 188.33333333333334, 187.16666666666666, 190.83333333333334, 215.66666666666666, 212.66666666666666, 186.5, 197.5, 206.5, 204.66666666666666, 189.0], [25450.333333333332, 7290.5, 4932.666666666667, 4325.833333333333, 2291.3333333333335, 2776.6666666666665, 1588.8333333333333, 1853.1666666666667, 1458.1666666666667, 1220.1666666666667, 950.1666666666666, 975.3333333333334, 764.3333333333334, 631.3333333333334, 616.1666666666666, 542.1666666666666, 523.8333333333334, 507.8333333333333, 459.0, 465.5, 418.1666666666667, 441.1666666666667, 397.6666666666667, 378.0, 338.1666666666667, 341.8333333333333, 350.8333333333333, 312.3333333333333, 341.8333333333333, 344.8333333333333, 376.0, 249.33333333333334, 345.1666666666667, 331.6666666666667, 270.5, 304.0, 282.3333333333333, 297.5, 271.8333333333333, 243.0, 260.6666666666667, 238.66666666666666, 245.5, 204.33333333333334, 302.3333333333333, 245.83333333333334, 264.6666666666667, 251.0, 250.66666666666666, 249.5, 268.8333333333333, 279.6666666666667, 235.33333333333334, 243.33333333333334, 262.8333333333333, 230.33333333333334, 265.5, 220.5, 212.66666666666666, 190.66666666666666, 208.16666666666666, 205.33333333333334, 206.83333333333334, 210.16666666666666, 199.33333333333334, 201.83333333333334, 216.5, 201.0, 194.83333333333334, 212.5, 219.66666666666666, 201.16666666666666, 213.83333333333334, 173.66666666666666, 205.5, 176.5, 202.66666666666666, 210.5, 224.5, 220.33333333333334, 198.33333333333334, 183.83333333333334, 217.16666666666666, 226.83333333333334, 222.16666666666666, 212.16666666666666, 243.66666666666666, 243.83333333333334, 247.66666666666666, 199.0, 228.0, 219.33333333333334, 222.33333333333334, 223.83333333333334, 224.33333333333334, 240.16666666666666, 258.0, 179.66666666666666, 226.33333333333334], [23404.833333333332, 6955.833333333333, 4315.833333333333, 3524.8333333333335, 2377.8333333333335, 2302.5, 2418.8333333333335, 2328.3333333333335, 1848.5, 1621.5, 1311.8333333333333, 1364.8333333333333, 1039.3333333333333, 884.1666666666666, 902.8333333333334, 776.6666666666666, 727.3333333333334, 726.3333333333334, 524.3333333333334, 433.8333333333333, 388.5, 386.5, 370.0, 349.0, 286.6666666666667, 268.5, 384.6666666666667, 401.1666666666667, 306.8333333333333, 258.0, 215.5, 202.33333333333334, 186.5, 222.5, 236.0, 185.66666666666666, 198.0, 173.5, 176.83333333333334, 180.16666666666666, 195.16666666666666, 383.6666666666667, 293.6666666666667, 259.6666666666667, 229.16666666666666, 212.33333333333334, 177.83333333333334, 218.83333333333334, 202.66666666666666, 187.33333333333334, 171.0, 170.0, 175.66666666666666, 198.33333333333334, 183.66666666666666, 296.6666666666667, 231.0, 220.16666666666666, 226.0, 314.3333333333333, 366.6666666666667, 220.16666666666666, 199.33333333333334, 197.0, 165.33333333333334, 172.16666666666666, 167.5, 201.5, 179.33333333333334, 188.0, 179.83333333333334, 225.66666666666666, 233.33333333333334, 160.66666666666666, 199.0, 142.83333333333334, 154.66666666666666, 137.66666666666666, 162.0, 194.5, 325.5, 203.5, 228.66666666666666, 177.83333333333334, 149.0, 174.66666666666666, 173.16666666666666, 186.5, 163.5, 194.66666666666666, 158.66666666666666, 180.83333333333334, 358.5, 424.3333333333333, 287.3333333333333, 220.83333333333334, 157.5, 204.83333333333334, 223.66666666666666]]

average2 = [[-9312.2, -5376.0, -4739.2, -3906.0, -3233.4, -3293.8, -2985.6, -2826.4, -2464.6, -1981.4, -1936.0, -1828.0, -1400.6, -1196.8, -1129.0, -857.4, -832.6, -659.8, -406.4, -399.2, -313.6, -355.8, -368.0, -355.6, -296.6, -277.4, -234.0, -234.2, -251.8, -212.0, -227.0, -212.0, -169.2, -248.6, -226.4, -238.8, -227.0, -184.6, -200.8, -170.2, -184.4, -185.2, -210.6, -203.2, -205.2, -178.6, -169.0, -174.6, -169.2, -189.4, -162.0, -192.8, -192.2, -151.2, -155.2, -161.0, -223.0, -164.4, -178.6, -139.4, -188.0, -208.0, -225.2, -252.8, -235.6, -253.4, -252.6, -198.2, -227.4, -210.8, -232.2, -211.2, -253.0, -212.4, -154.6, -204.6, -244.0, -242.0, -224.6, -272.6, -253.0, -239.2, -203.2, -206.8, -225.2, -219.0, -212.8, -204.6, -218.6, -200.0, -153.8, -175.4, -161.6, -241.8, -223.6, -227.2, -194.2, -196.6, -172.6], [-14944.5, -7794.166666666667, -4208.0, -2554.1666666666665, -1728.8333333333333, -1469.3333333333333, -1401.1666666666667, -1166.0, -1165.0, -1140.8333333333333, -1078.8333333333333, -927.0, -868.8333333333334, -558.8333333333334, -612.6666666666666, -529.1666666666666, -485.8333333333333, -517.6666666666666, -415.6666666666667, -689.6666666666666, -845.5, -577.1666666666666, -489.8333333333333, -504.6666666666667, -354.1666666666667, -363.3333333333333, -311.0, -362.6666666666667, -376.8333333333333, -331.6666666666667, -426.5, -390.1666666666667, -420.6666666666667, -347.1666666666667, -322.0, -355.1666666666667, -315.0, -287.8333333333333, -312.8333333333333, -313.8333333333333, -276.8333333333333, -454.6666666666667, -408.0, -304.0, -355.1666666666667, -341.5, -268.5, -357.1666666666667, -254.83333333333334, -312.8333333333333, -267.1666666666667, -274.5, -302.0, -338.3333333333333, -264.5, -239.5, -259.5, -266.1666666666667, -262.6666666666667, -258.8333333333333, -227.5, -246.33333333333334, -251.83333333333334, -193.5, -293.1666666666667, -289.1666666666667, -333.6666666666667, -273.0, -231.33333333333334, -250.0, -225.66666666666666, -293.8333333333333, -244.0, -209.0, -234.33333333333334, -279.8333333333333, -390.1666666666667, -332.8333333333333, -297.3333333333333, -260.3333333333333, -225.66666666666666, -205.33333333333334, -253.83333333333334, -281.0, -210.16666666666666, -177.0, -183.66666666666666, -238.66666666666666, -230.33333333333334, -225.66666666666666, -219.16666666666666, -235.66666666666666, -216.0, -215.83333333333334, -171.33333333333334, -201.33333333333334, -218.66666666666666, -244.33333333333334, -225.83333333333334], [-16136.166666666666, -5986.166666666667, -6599.5, -7593.166666666667, -5005.333333333333, -2961.6666666666665, -2171.5, -1927.0, -1874.3333333333333, -1863.5, -1617.8333333333333, -1391.0, -1129.3333333333333, -926.1666666666666, -984.6666666666666, -824.8333333333334, -725.8333333333334, -808.0, -645.3333333333334, -707.6666666666666, -603.6666666666666, -592.6666666666666, -544.1666666666666, -491.3333333333333, -472.6666666666667, -544.0, -453.6666666666667, -429.0, -454.8333333333333, -452.5, -408.8333333333333, -367.3333333333333, -383.1666666666667, -428.6666666666667, -363.0, -357.0, -384.3333333333333, -365.6666666666667, -313.5, -311.6666666666667, -281.0, -278.6666666666667, -300.0, -260.6666666666667, -262.3333333333333, -260.6666666666667, -278.0, -264.8333333333333, -312.6666666666667, -245.83333333333334, -208.83333333333334, -256.3333333333333, -267.5, -251.0, -218.16666666666666, -231.16666666666666, -235.33333333333334, -309.1666666666667, -241.33333333333334, -228.16666666666666, -214.5, -184.5, -263.1666666666667, -224.83333333333334, -218.33333333333334, -246.5, -245.16666666666666, -233.5, -207.33333333333334, -289.0, -253.0, -241.0, -241.0, -247.33333333333334, -260.6666666666667, -209.0, -255.66666666666666, -233.16666666666666, -229.66666666666666, -193.0, -247.66666666666666, -203.33333333333334, -246.33333333333334, -220.0, -208.5, -251.66666666666666, -257.0, -279.5, -258.1666666666667, -311.5, -221.33333333333334, -214.66666666666666, -251.83333333333334, -228.33333333333334, -250.83333333333334, -224.83333333333334, -231.5, -220.5, -213.16666666666666], [-24649.833333333332, -7880.666666666667, -5462.666666666667, -3937.1666666666665, -3238.6666666666665, -2553.5, -2461.0, -1842.3333333333333, -1705.5, -1301.5, -1480.6666666666667, -1069.6666666666667, -942.0, -893.8333333333334, -866.6666666666666, -793.1666666666666, -627.8333333333334, -650.1666666666666, -490.6666666666667, -516.8333333333334, -467.0, -452.8333333333333, -401.6666666666667, -379.8333333333333, -383.0, -391.8333333333333, -402.1666666666667, -319.0, -336.1666666666667, -355.6666666666667, -313.8333333333333, -269.3333333333333, -286.5, -294.0, -260.3333333333333, -222.5, -233.16666666666666, -225.66666666666666, -310.8333333333333, -249.83333333333334, -195.66666666666666, -255.83333333333334, -236.33333333333334, -216.0, -259.5, -238.16666666666666, -226.33333333333334, -190.66666666666666, -224.0, -311.3333333333333, -276.0, -235.83333333333334, -252.66666666666666, -177.5, -215.5, -212.83333333333334, -202.16666666666666, -249.66666666666666, -201.66666666666666, -192.16666666666666, -185.33333333333334, -180.66666666666666, -178.16666666666666, -202.66666666666666, -211.0, -223.5, -221.5, -210.83333333333334, -240.5, -261.8333333333333, -268.3333333333333, -230.16666666666666, -183.83333333333334, -218.16666666666666, -220.33333333333334, -190.16666666666666, -232.66666666666666, -195.5, -185.66666666666666, -177.5, -225.5, -206.5, -188.0, -234.66666666666666, -192.16666666666666, -176.33333333333334, -209.83333333333334, -186.83333333333334, -184.16666666666666, -170.66666666666666, -182.33333333333334, -160.16666666666666, -225.33333333333334, -155.0, -169.83333333333334, -224.0, -183.5, -217.0, -188.0], [-22746.833333333332, -8069.833333333333, -4093.6666666666665, -4008.5, -1970.3333333333333, -2410.6666666666665, -1672.8333333333333, -1794.1666666666667, -1382.5, -1206.0, -979.6666666666666, -973.6666666666666, -743.5, -716.0, -615.1666666666666, -504.6666666666667, -567.8333333333334, -469.0, -432.3333333333333, -419.6666666666667, -385.3333333333333, -389.5, -350.8333333333333, -351.3333333333333, -351.3333333333333, -310.6666666666667, -369.1666666666667, -335.0, -375.0, -372.0, -341.0, -307.5, -333.1666666666667, -316.6666666666667, -269.1666666666667, -241.66666666666666, -296.8333333333333, -244.66666666666666, -271.3333333333333, -252.5, -208.83333333333334, -236.33333333333334, -259.8333333333333, -273.1666666666667, -278.8333333333333, -250.16666666666666, -233.5, -227.33333333333334, -249.66666666666666, -225.83333333333334, -260.6666666666667, -240.66666666666666, -230.0, -259.6666666666667, -223.0, -238.5, -233.0, -215.33333333333334, -207.66666666666666, -215.16666666666666, -201.5, -196.5, -217.66666666666666, -221.33333333333334, -202.83333333333334, -192.5, -185.33333333333334, -173.83333333333334, -210.0, -197.16666666666666, -213.0, -216.16666666666666, -184.83333333333334, -158.16666666666666, -205.83333333333334, -192.16666666666666, -181.0, -190.5, -238.0, -213.66666666666666, -219.0, -268.1666666666667, -205.16666666666666, -221.83333333333334, -215.0, -211.16666666666666, -207.16666666666666, -262.3333333333333, -214.0, -223.16666666666666, -228.0, -197.16666666666666, -222.0, -239.66666666666666, -232.83333333333334, -225.33333333333334, -216.33333333333334, -180.83333333333334, -219.66666666666666], [-21530.0, -6925.166666666667, -4262.166666666667, -2909.3333333333335, -2370.3333333333335, -2055.8333333333335, -2356.6666666666665, -1970.1666666666667, -1871.8333333333333, -1644.6666666666667, -1123.8333333333333, -1173.3333333333333, -1073.5, -842.3333333333334, -886.0, -865.3333333333334, -712.1666666666666, -712.5, -545.6666666666666, -404.1666666666667, -356.5, -351.1666666666667, -381.3333333333333, -330.3333333333333, -296.1666666666667, -383.5, -435.6666666666667, -322.5, -266.6666666666667, -235.33333333333334, -252.83333333333334, -223.83333333333334, -208.16666666666666, -232.83333333333334, -220.16666666666666, -173.16666666666666, -162.33333333333334, -178.83333333333334, -191.66666666666666, -269.1666666666667, -395.3333333333333, -327.3333333333333, -237.33333333333334, -197.0, -189.33333333333334, -172.83333333333334, -184.66666666666666, -157.5, -160.66666666666666, -187.16666666666666, -195.83333333333334, -166.33333333333334, -170.83333333333334, -242.33333333333334, -328.3333333333333, -199.83333333333334, -234.66666666666666, -205.83333333333334, -201.5, -191.83333333333334, -242.83333333333334, -337.1666666666667, -164.83333333333334, -198.33333333333334, -180.16666666666666, -188.33333333333334, -191.66666666666666, -191.83333333333334, -186.16666666666666, -162.0, -173.5, -170.16666666666666, -201.33333333333334, -211.16666666666666, -169.16666666666666, -169.66666666666666, -171.16666666666666, -184.0, -294.6666666666667, -161.83333333333334, -214.16666666666666, -175.33333333333334, -182.5, -190.83333333333334, -189.0, -167.33333333333334, -165.0, -192.33333333333334, -158.16666666666666, -254.16666666666666, -269.5, -176.33333333333334, -188.33333333333334, -170.16666666666666, -295.8333333333333, -401.8333333333333, -233.16666666666666, -197.5, -174.83333333333334]]

average3 = [[9508.6, 5658.4, 5214.6, 4067.4, 3061.2, 2977.8, 2918.6, 2691.2, 2776.0, 2137.6, 2048.2, 1701.6, 1435.2, 1419.4, 1028.6, 969.8, 828.6, 596.4, 436.8, 359.6, 346.0, 347.0, 407.4, 394.6, 341.4, 283.0, 224.8, 282.2, 243.4, 286.4, 266.4, 200.2, 177.8, 186.4, 223.8, 229.2, 244.6, 205.0, 204.2, 188.6, 194.0, 178.8, 222.0, 175.6, 212.0, 185.8, 207.6, 166.0, 160.8, 181.6, 189.2, 196.0, 181.4, 153.0, 129.0, 152.2, 188.2, 170.0, 168.4, 183.4, 194.4, 190.8, 203.4, 237.0, 204.0, 237.8, 253.0, 251.4, 191.8, 231.8, 227.0, 222.8, 259.6, 216.6, 176.6, 209.4, 183.4, 209.2, 231.0, 255.2, 279.4, 268.6, 190.8, 218.0, 211.8, 199.2, 253.2, 202.6, 207.2, 241.0, 185.6, 168.6, 169.8, 187.8, 209.2, 177.4, 228.4, 190.2, 173.0], [16788.833333333332, 8497.333333333334, 5442.333333333333, 2694.5, 1591.6666666666667, 1486.8333333333333, 1333.3333333333333, 1282.3333333333333, 1281.3333333333333, 954.1666666666666, 1101.6666666666667, 892.3333333333334, 769.3333333333334, 514.8333333333334, 584.0, 533.3333333333334, 521.6666666666666, 463.6666666666667, 446.6666666666667, 801.5, 738.6666666666666, 515.5, 490.5, 450.6666666666667, 363.0, 376.0, 429.5, 397.1666666666667, 344.5, 362.8333333333333, 409.6666666666667, 428.1666666666667, 378.8333333333333, 352.1666666666667, 375.3333333333333, 373.5, 308.0, 377.0, 376.5, 274.1666666666667, 301.0, 285.0, 412.1666666666667, 391.1666666666667, 368.1666666666667, 359.1666666666667, 345.8333333333333, 244.33333333333334, 315.3333333333333, 272.0, 262.5, 267.1666666666667, 229.16666666666666, 250.66666666666666, 353.3333333333333, 262.6666666666667, 235.33333333333334, 234.83333333333334, 228.5, 208.5, 230.5, 281.8333333333333, 241.33333333333334, 257.8333333333333, 259.3333333333333, 290.6666666666667, 330.3333333333333, 339.8333333333333, 281.3333333333333, 224.83333333333334, 213.83333333333334, 248.16666666666666, 239.33333333333334, 279.1666666666667, 261.6666666666667, 218.5, 173.0, 278.0, 358.3333333333333, 269.6666666666667, 332.5, 211.33333333333334, 241.83333333333334, 236.5, 235.0, 239.5, 183.16666666666666, 238.0, 212.33333333333334, 219.66666666666666, 224.16666666666666, 199.83333333333334, 212.5, 197.66666666666666, 175.66666666666666, 249.33333333333334, 217.66666666666666, 208.0, 183.66666666666666], [17083.333333333332, 5804.5, 7363.833333333333, 7127.5, 4784.5, 3038.5, 2550.5, 2002.8333333333333, 1784.3333333333333, 1829.5, 1454.0, 1227.8333333333333, 1114.3333333333333, 1000.0, 888.6666666666666, 854.1666666666666, 762.5, 731.6666666666666, 643.0, 644.0, 609.6666666666666, 647.1666666666666, 531.1666666666666, 531.1666666666666, 452.6666666666667, 457.3333333333333, 482.8333333333333, 413.5, 377.5, 415.1666666666667, 402.6666666666667, 395.6666666666667, 403.3333333333333, 353.3333333333333, 366.0, 366.3333333333333, 407.3333333333333, 331.8333333333333, 305.8333333333333, 320.8333333333333, 250.66666666666666, 288.1666666666667, 303.6666666666667, 249.83333333333334, 309.3333333333333, 282.3333333333333, 231.0, 259.6666666666667, 227.0, 221.66666666666666, 220.0, 252.5, 268.1666666666667, 253.83333333333334, 185.83333333333334, 262.1666666666667, 240.16666666666666, 268.5, 268.0, 220.66666666666666, 237.33333333333334, 201.16666666666666, 269.1666666666667, 242.66666666666666, 244.66666666666666, 242.33333333333334, 226.66666666666666, 299.0, 240.0, 223.66666666666666, 254.0, 239.16666666666666, 225.66666666666666, 239.33333333333334, 218.16666666666666, 216.66666666666666, 253.33333333333334, 223.33333333333334, 204.33333333333334, 236.16666666666666, 238.5, 247.16666666666666, 224.33333333333334, 239.16666666666666, 244.83333333333334, 259.6666666666667, 241.33333333333334, 299.6666666666667, 225.16666666666666, 259.5, 263.0, 238.5, 235.66666666666666, 217.83333333333334, 246.16666666666666, 230.0, 202.83333333333334, 237.0, 228.83333333333334], [23885.5, 8563.833333333334, 6189.833333333333, 4566.5, 3138.6666666666665, 2817.1666666666665, 2376.6666666666665, 2061.6666666666665, 1800.5, 1326.0, 1355.3333333333333, 1145.0, 1082.3333333333333, 846.6666666666666, 949.8333333333334, 745.6666666666666, 676.3333333333334, 605.3333333333334, 512.1666666666666, 582.3333333333334, 424.8333333333333, 470.5, 355.3333333333333, 389.0, 394.1666666666667, 403.0, 372.3333333333333, 323.6666666666667, 380.0, 324.5, 274.8333333333333, 321.5, 235.33333333333334, 273.1666666666667, 258.8333333333333, 219.5, 240.83333333333334, 215.66666666666666, 253.0, 296.1666666666667, 193.83333333333334, 259.6666666666667, 224.0, 237.83333333333334, 188.0, 244.0, 207.33333333333334, 210.5, 245.16666666666666, 223.83333333333334, 268.5, 254.66666666666666, 249.83333333333334, 228.33333333333334, 179.16666666666666, 245.83333333333334, 275.5, 245.0, 181.33333333333334, 181.33333333333334, 150.33333333333334, 190.5, 204.83333333333334, 163.66666666666666, 219.16666666666666, 236.83333333333334, 199.83333333333334, 225.66666666666666, 263.5, 251.5, 235.33333333333334, 192.16666666666666, 224.5, 227.83333333333334, 196.33333333333334, 222.33333333333334, 211.66666666666666, 216.16666666666666, 195.33333333333334, 186.16666666666666, 243.66666666666666, 176.83333333333334, 203.5, 199.33333333333334, 194.5, 199.16666666666666, 188.66666666666666, 162.16666666666666, 198.5, 188.33333333333334, 187.16666666666666, 190.83333333333334, 215.66666666666666, 212.66666666666666, 186.5, 197.5, 206.5, 204.66666666666666, 189.0], [25450.333333333332, 7290.5, 4932.666666666667, 4325.833333333333, 2291.3333333333335, 2776.6666666666665, 1588.8333333333333, 1853.1666666666667, 1458.1666666666667, 1220.1666666666667, 950.1666666666666, 975.3333333333334, 764.3333333333334, 631.3333333333334, 616.1666666666666, 542.1666666666666, 523.8333333333334, 507.8333333333333, 459.0, 465.5, 418.1666666666667, 441.1666666666667, 397.6666666666667, 378.0, 338.1666666666667, 341.8333333333333, 350.8333333333333, 312.3333333333333, 341.8333333333333, 344.8333333333333, 376.0, 249.33333333333334, 345.1666666666667, 331.6666666666667, 270.5, 304.0, 282.3333333333333, 297.5, 271.8333333333333, 243.0, 260.6666666666667, 238.66666666666666, 245.5, 204.33333333333334, 302.3333333333333, 245.83333333333334, 264.6666666666667, 251.0, 250.66666666666666, 249.5, 268.8333333333333, 279.6666666666667, 235.33333333333334, 243.33333333333334, 262.8333333333333, 230.33333333333334, 265.5, 220.5, 212.66666666666666, 190.66666666666666, 208.16666666666666, 205.33333333333334, 206.83333333333334, 210.16666666666666, 199.33333333333334, 201.83333333333334, 216.5, 201.0, 194.83333333333334, 212.5, 219.66666666666666, 201.16666666666666, 213.83333333333334, 173.66666666666666, 205.5, 176.5, 202.66666666666666, 210.5, 224.5, 220.33333333333334, 198.33333333333334, 183.83333333333334, 217.16666666666666, 226.83333333333334, 222.16666666666666, 212.16666666666666, 243.66666666666666, 243.83333333333334, 247.66666666666666, 199.0, 228.0, 219.33333333333334, 222.33333333333334, 223.83333333333334, 224.33333333333334, 240.16666666666666, 258.0, 179.66666666666666, 226.33333333333334], [23404.833333333332, 6955.833333333333, 4315.833333333333, 3524.8333333333335, 2377.8333333333335, 2302.5, 2418.8333333333335, 2328.3333333333335, 1848.5, 1621.5, 1311.8333333333333, 1364.8333333333333, 1039.3333333333333, 884.1666666666666, 902.8333333333334, 776.6666666666666, 727.3333333333334, 726.3333333333334, 524.3333333333334, 433.8333333333333, 388.5, 386.5, 370.0, 349.0, 286.6666666666667, 268.5, 384.6666666666667, 401.1666666666667, 306.8333333333333, 258.0, 215.5, 202.33333333333334, 186.5, 222.5, 236.0, 185.66666666666666, 198.0, 173.5, 176.83333333333334, 180.16666666666666, 195.16666666666666, 383.6666666666667, 293.6666666666667, 259.6666666666667, 229.16666666666666, 212.33333333333334, 177.83333333333334, 218.83333333333334, 202.66666666666666, 187.33333333333334, 171.0, 170.0, 175.66666666666666, 198.33333333333334, 183.66666666666666, 296.6666666666667, 231.0, 220.16666666666666, 226.0, 314.3333333333333, 366.6666666666667, 220.16666666666666, 199.33333333333334, 197.0, 165.33333333333334, 172.16666666666666, 167.5, 201.5, 179.33333333333334, 188.0, 179.83333333333334, 225.66666666666666, 233.33333333333334, 160.66666666666666, 199.0, 142.83333333333334, 154.66666666666666, 137.66666666666666, 162.0, 194.5, 325.5, 203.5, 228.66666666666666, 177.83333333333334, 149.0, 174.66666666666666, 173.16666666666666, 186.5, 163.5, 194.66666666666666, 158.66666666666666, 180.83333333333334, 358.5, 424.3333333333333, 287.3333333333333, 220.83333333333334, 157.5, 204.83333333333334, 223.66666666666666]]

average4 = [[0.0, 1689.6, 2374.6, 3379.8, 4589.6, 5663.6, 6139.0, 7317.4, 8712.8, 9234.8, 10529.8, 11298.4, 12589.2, 13507.6, 14412.0, 15787.6, 16477.6, 17377.2, 18437.8, 19322.0, 20251.0, 21739.2, 22744.6, 23296.4, 24636.0, 25213.2, 26603.4, 27697.8, 28340.8, 29376.4, 30595.0, 31513.4, 32862.2, 33809.2, 34414.6, 35646.0, 36713.6, 37403.6, 38587.0, 39563.0, 40580.6, 41434.4, 42625.8, 43571.8, 44519.4, 45427.2, 46644.8, 47667.6, 48474.6, 49546.0, 50514.0, 51627.4, 52577.0, 53439.2, 54548.0, 55693.8, 56634.0, 57222.6, 58373.0, 59672.0, 60377.4, 61572.2, 62658.8, 63471.2, 64486.2, 65640.8, 66363.6, 67472.4, 68326.0, 69535.4, 70444.2, 71673.8, 72586.6, 73369.8, 74529.0, 75561.8, 76453.6, 77440.6, 78801.6, 79915.6, 80463.4, 81474.2, 82422.6, 83466.0, 84390.4, 85453.6, 86587.8, 87360.8, 88551.6, 89667.0, 90226.0, 91770.6, 92624.4, 93669.6, 94586.4, 95376.4, 96421.8, 97702.0, 98346.8], [0.0, 1321.1666666666667, 1776.5, 2831.3333333333335, 3713.1666666666665, 4598.5, 5310.833333333333, 6127.833333333333, 7037.0, 7816.0, 8796.5, 9465.0, 10411.833333333334, 11302.333333333334, 11920.166666666666, 12887.0, 13949.0, 14524.5, 15540.833333333334, 16175.166666666666, 17208.0, 17775.666666666668, 18891.5, 19380.5, 20434.166666666668, 21283.666666666668, 21947.333333333332, 22976.666666666668, 23857.833333333332, 24515.166666666668, 25538.166666666668, 26278.5, 26808.666666666668, 27812.0, 28643.0, 29510.333333333332, 30448.833333333332, 31081.333333333332, 32191.166666666668, 32928.333333333336, 33714.0, 34791.333333333336, 35502.0, 36335.0, 37167.5, 37912.833333333336, 38553.333333333336, 39581.166666666664, 40282.5, 41305.833333333336, 42105.833333333336, 42915.333333333336, 43725.5, 44680.333333333336, 45488.166666666664, 46256.666666666664, 47100.333333333336, 47663.333333333336, 48855.833333333336, 49712.5, 50371.333333333336, 51143.166666666664, 51956.5, 52938.0, 53739.833333333336, 54692.0, 55323.0, 55960.833333333336, 57014.5, 57962.833333333336, 58738.333333333336, 59631.166666666664, 60350.166666666664, 61292.666666666664, 62011.0, 63039.5, 63625.333333333336, 64724.666666666664, 65468.833333333336, 66146.66666666667, 66937.33333333333, 67972.33333333333, 68776.5, 69724.83333333333, 70294.0, 71202.0, 72065.83333333333, 72846.5, 73835.5, 74687.5, 75401.5, 76175.33333333333, 77044.16666666667, 77914.5, 78713.33333333333, 79496.33333333333, 80272.33333333333, 81023.5, 82145.5], [0.0, 1267.5, 2221.3333333333335, 2587.3333333333335, 3399.6666666666665, 4495.833333333333, 5221.833333333333, 6285.666666666667, 6920.833333333333, 7827.666666666667, 8918.0, 9529.666666666666, 10295.333333333334, 11300.333333333334, 11804.5, 13010.333333333334, 13666.5, 14565.5, 15369.833333333334, 16281.0, 17053.5, 18069.5, 18522.0, 19592.0, 20421.833333333332, 21223.666666666668, 21904.5, 22844.333333333332, 23955.0, 24422.333333333332, 25376.5, 26313.666666666668, 27296.5, 27908.833333333332, 28645.833333333332, 29601.666666666668, 30280.0, 31190.833333333332, 32072.0, 32959.666666666664, 33681.166666666664, 34628.833333333336, 35235.0, 36321.833333333336, 36855.833333333336, 38053.5, 38698.166666666664, 39605.0, 40423.5, 41278.666666666664, 41913.0, 42764.333333333336, 43695.666666666664, 44665.666666666664, 45387.5, 46282.5, 47023.0, 47970.0, 48576.166666666664, 49455.833333333336, 50433.0, 51349.666666666664, 52059.5, 52806.333333333336, 53822.0, 54510.166666666664, 55361.5, 56287.5, 56906.333333333336, 57855.333333333336, 58674.333333333336, 59551.166666666664, 60570.0, 61248.333333333336, 62112.5, 62667.5, 63750.0, 64647.0, 65398.5, 66115.33333333333, 67131.83333333333, 67940.0, 68832.66666666667, 69603.16666666667, 70377.83333333333, 71470.33333333333, 72000.5, 72958.0, 73688.83333333333, 74683.83333333333, 75298.0, 76228.5, 77131.5, 78083.66666666667, 78704.0, 79662.5, 80395.66666666667, 81189.0, 82139.16666666667], [0.0, 1002.1666666666666, 1942.8333333333333, 2712.6666666666665, 3611.0, 4650.666666666667, 5120.833333333333, 6296.833333333333, 6907.833333333333, 7950.666666666667, 8725.0, 9458.333333333334, 10377.0, 11095.166666666666, 12151.333333333334, 12811.666666666666, 13895.333333333334, 14465.333333333334, 15435.333333333334, 16222.833333333334, 17098.833333333332, 17788.833333333332, 18856.333333333332, 19552.0, 20322.666666666668, 21171.833333333332, 22005.0, 22951.5, 23728.666666666668, 24572.833333333332, 25269.0, 26378.666666666668, 27037.666666666668, 28064.166666666668, 28724.333333333332, 29447.833333333332, 30348.833333333332, 31211.333333333332, 32181.833333333332, 32676.166666666668, 33489.833333333336, 34524.833333333336, 35354.5, 36333.833333333336, 36949.0, 37844.333333333336, 38707.5, 39767.333333333336, 40403.666666666664, 41246.166666666664, 42198.0, 42731.0, 44016.5, 44512.0, 45464.333333333336, 46076.166666666664, 47124.5, 47997.333333333336, 48531.666666666664, 49449.0, 50375.5, 51183.666666666664, 52190.333333333336, 52843.166666666664, 53558.5, 54311.333333333336, 55396.0, 56408.333333333336, 57190.5, 57572.333333333336, 58773.333333333336, 59792.5, 60255.333333333336, 61100.0, 62044.833333333336, 62955.5, 63670.833333333336, 64720.333333333336, 65246.0, 66435.0, 67067.0, 67858.83333333333, 68841.16666666667, 69790.5, 70462.83333333333, 71325.83333333333, 72132.83333333333, 72923.33333333333, 73729.0, 74513.33333333333, 75152.0, 76091.16666666667, 77154.0, 77725.0, 78763.16666666667, 79605.66666666667, 80604.0, 81169.0, 82116.33333333333], [0.0, 1240.5, 1786.8333333333333, 2794.0, 3593.1666666666665, 4500.833333333333, 5426.666666666667, 6145.166666666667, 6883.333333333333, 7745.166666666667, 8678.0, 9553.333333333334, 10437.5, 11345.5, 12268.333333333334, 13052.833333333334, 13837.0, 14463.5, 15501.166666666666, 16419.0, 17104.833333333332, 18058.5, 18729.333333333332, 19539.0, 20313.833333333332, 21249.5, 21986.166666666668, 22906.5, 23938.0, 24352.0, 25309.666666666668, 26251.833333333332, 27021.833333333332, 27850.666666666668, 28595.333333333332, 29632.5, 30371.166666666668, 31234.0, 32087.833333333332, 33048.0, 33883.666666666664, 34506.0, 35428.833333333336, 36294.333333333336, 37050.166666666664, 37808.5, 38803.833333333336, 39740.833333333336, 40534.333333333336, 41290.666666666664, 42018.666666666664, 42819.666666666664, 43839.333333333336, 44443.5, 45290.5, 45983.5, 47172.833333333336, 47904.166666666664, 48718.5, 49646.833333333336, 50218.0, 51033.5, 52133.5, 53053.333333333336, 53680.0, 54428.5, 55371.0, 56239.0, 57050.833333333336, 57822.0, 58728.5, 59471.666666666664, 60427.0, 61422.333333333336, 62155.5, 63028.0, 63884.833333333336, 64383.833333333336, 65570.66666666667, 66172.66666666667, 67153.0, 67908.5, 68671.5, 69264.0, 70405.83333333333, 71372.16666666667, 72021.5, 72920.5, 73746.16666666667, 74633.5, 75506.5, 76194.66666666667, 77423.33333333333, 77804.33333333333, 78840.16666666667, 79705.0, 80258.66666666667, 81372.5, 82127.33333333333], [0.0, 1045.5, 1900.0, 2644.8333333333335, 3539.8333333333335, 4500.666666666667, 5319.166666666667, 6118.166666666667, 7193.0, 7790.5, 8751.0, 9572.0, 10179.833333333334, 11085.666666666666, 11797.666666666666, 12821.166666666666, 13831.5, 14525.666666666666, 15098.666666666666, 16302.666666666666, 17137.5, 17757.833333333332, 18775.5, 19484.666666666668, 20172.0, 21149.833333333332, 22157.833333333332, 22941.5, 23713.166666666668, 24404.0, 25304.0, 26186.166666666668, 27173.5, 27994.666666666668, 28624.166666666668, 29750.333333333332, 30243.666666666668, 30999.5, 32114.833333333332, 32774.833333333336, 33843.166666666664, 34715.666666666664, 35259.666666666664, 36308.0, 37061.0, 37925.666666666664, 38912.166666666664, 39634.166666666664, 40313.333333333336, 41221.166666666664, 41818.833333333336, 43162.833333333336, 43661.5, 44554.166666666664, 45497.166666666664, 46324.5, 47199.333333333336, 47778.333333333336, 48576.666666666664, 49607.166666666664, 50353.0, 51311.166666666664, 51829.0, 52956.333333333336, 53710.666666666664, 54688.833333333336, 55369.166666666664, 56336.666666666664, 57299.833333333336, 57725.166666666664, 58600.666666666664, 59680.166666666664, 60361.333333333336, 61345.5, 61941.833333333336, 62867.166666666664, 63837.0, 64749.5, 65139.5, 66326.33333333333, 67020.16666666667, 67913.33333333333, 68851.16666666667, 69455.16666666667, 70345.16666666667, 71176.0, 72187.66666666667, 72781.5, 73917.33333333333, 74546.66666666667, 75292.83333333333, 76249.33333333333, 77227.0, 77816.16666666667, 78576.5, 79486.5, 80572.66666666667, 81419.16666666667, 82092.16666666667]]

average5 = [[9867.0, 6894.2, 6143.0, 4302.4, 3320.4, 2788.4, 2634.6, 2814.8, 2860.0, 2647.8, 2712.2, 2509.4, 2404.0, 2316.6, 2307.6, 1905.4, 1670.0, 1335.6, 1069.8, 812.6, 705.2, 635.6, 580.4, 484.6, 529.4, 406.4, 481.8, 390.2, 325.8, 394.2, 369.6, 332.0, 321.2, 305.6, 301.4, 260.0, 319.6, 304.6, 346.0, 341.8, 270.0, 291.0, 265.6, 264.6, 254.8, 225.8, 318.8, 227.4, 193.4, 232.0, 296.0, 240.8, 222.8, 255.2, 238.4, 205.6, 263.2, 220.0, 262.0, 270.8, 290.4, 182.6, 229.8, 254.0, 236.0, 223.4, 262.6, 228.8, 239.4, 209.8, 221.4, 195.4, 222.6, 219.6, 191.6, 227.0, 217.0, 262.8, 246.6, 186.8, 238.2, 241.6, 238.6, 229.8, 321.2, 216.4, 265.6, 259.8, 221.0, 220.8, 206.0, 203.0, 214.2, 234.0, 206.4, 270.8, 191.0, 211.2, 233.2], [13923.2, 8523.6, 5454.8, 3815.0, 2657.2, 2298.4, 2137.6, 1757.2, 1693.2, 1518.6, 1302.2, 1062.0, 869.0, 892.0, 806.4, 876.6, 847.8, 719.0, 732.4, 741.2, 655.2, 580.8, 601.0, 618.0, 537.6, 485.4, 444.0, 575.4, 565.4, 598.6, 457.0, 476.0, 495.2, 389.4, 426.2, 403.4, 475.8, 410.6, 462.6, 501.2, 502.4, 390.2, 401.2, 454.8, 385.8, 406.2, 322.2, 384.2, 348.2, 362.8, 403.0, 371.2, 435.2, 320.6, 370.4, 380.4, 398.4, 393.8, 381.2, 443.4, 387.6, 424.0, 406.6, 382.0, 382.2, 403.0, 324.4, 402.0, 330.8, 336.4, 357.6, 418.6, 447.0, 366.4, 349.2, 353.4, 329.4, 312.8, 327.4, 334.6, 301.8, 291.6, 290.6, 405.0, 287.8, 372.4, 273.8, 305.6, 308.4, 340.6, 269.6, 339.6, 308.6, 284.8, 281.0, 305.8, 282.0, 316.0, 343.8], [14062.4, 10840.4, 9960.2, 6016.8, 3743.6, 3674.8, 3256.4, 3308.8, 2965.8, 2700.4, 2568.0, 2731.0, 2399.6, 1850.6, 1441.6, 1429.6, 1352.0, 1133.4, 889.4, 902.0, 707.4, 857.0, 854.4, 608.8, 679.2, 538.0, 622.4, 686.0, 623.6, 593.8, 553.2, 584.4, 518.4, 614.2, 478.0, 527.6, 550.4, 523.6, 553.0, 555.4, 549.4, 449.6, 475.6, 442.8, 507.0, 499.4, 537.4, 501.6, 456.8, 500.2, 415.4, 492.4, 460.0, 584.4, 449.4, 556.4, 497.8, 411.4, 433.4, 380.6, 404.8, 391.6, 334.4, 432.4, 376.2, 367.6, 387.8, 381.0, 378.4, 359.8, 371.0, 346.8, 343.2, 365.2, 360.4, 385.6, 388.6, 395.8, 351.2, 334.4, 350.4, 377.0, 314.4, 347.0, 273.2, 313.4, 356.0, 343.6, 343.0, 312.8, 314.6, 323.8, 279.8, 325.8, 345.2, 329.0, 350.8, 364.8, 317.4], [27589.6, 10700.2, 6015.4, 4639.8, 3415.4, 3021.0, 2796.2, 2189.8, 1743.2, 1853.0, 1702.6, 1462.8, 1272.2, 1189.8, 1026.0, 854.8, 870.4, 811.6, 739.6, 659.2, 610.0, 482.6, 462.2, 489.8, 456.6, 404.0, 315.6, 413.0, 329.8, 363.4, 359.8, 347.2, 324.2, 362.0, 398.6, 373.2, 402.6, 341.8, 352.4, 335.2, 338.0, 277.2, 252.8, 275.2, 301.4, 305.0, 255.2, 246.0, 304.0, 318.2, 231.2, 233.4, 250.0, 272.4, 229.8, 234.2, 213.6, 252.6, 234.0, 270.6, 241.6, 218.4, 279.2, 240.2, 207.8, 286.4, 192.2, 247.8, 248.0, 240.0, 238.8, 254.2, 204.4, 193.8, 229.8, 205.2, 215.8, 207.8, 219.0, 225.8, 190.0, 218.0, 233.2, 227.6, 222.2, 190.8, 214.4, 192.2, 175.2, 184.4, 181.8, 239.2, 299.4, 266.4, 257.0, 219.6, 224.8, 175.4, 201.2], [26086.2, 7407.4, 4023.0, 2773.2, 2201.2, 2098.6, 2012.8, 1795.8, 1561.8, 1463.8, 1345.8, 1108.0, 975.4, 972.4, 932.4, 972.0, 866.2, 794.2, 672.4, 611.6, 681.8, 584.2, 658.8, 553.8, 577.4, 547.2, 507.8, 575.4, 476.6, 544.0, 491.0, 405.4, 460.4, 575.4, 513.6, 504.0, 492.0, 559.6, 502.8, 637.0, 500.4, 613.4, 554.6, 511.0, 545.2, 593.6, 626.6, 623.0, 588.2, 698.2, 638.4, 641.8, 699.8, 591.4, 611.2, 604.6, 582.6, 512.8, 542.6, 522.0, 507.0, 431.6, 456.6, 447.4, 401.8, 338.4, 353.0, 285.2, 340.4, 277.2, 344.2, 337.6, 342.2, 419.0, 380.0, 392.2, 275.4, 336.6, 358.0, 380.2, 345.2, 302.2, 359.6, 394.8, 359.4, 373.8, 378.6, 423.4, 402.4, 335.8, 366.8, 326.2, 311.0, 228.6, 337.4, 253.6, 322.4, 261.4, 414.8], [28197.8, 6603.8, 3951.2, 2805.6, 1780.8, 1286.4, 1306.6, 1348.4, 1082.4, 808.8, 850.6, 658.2, 646.4, 525.0, 487.2, 569.6, 480.4, 445.8, 445.4, 396.4, 308.8, 274.4, 344.2, 277.8, 267.0, 278.0, 285.6, 268.4, 244.0, 280.6, 218.0, 224.6, 191.8, 200.8, 238.2, 195.2, 207.4, 204.4, 194.8, 188.6, 247.6, 174.4, 224.0, 196.6, 242.4, 226.6, 217.8, 178.4, 250.8, 231.6, 227.8, 239.2, 233.2, 215.8, 215.4, 190.8, 218.6, 209.8, 213.6, 244.2, 267.2, 244.6, 183.8, 204.4, 231.4, 231.4, 239.2, 258.6, 270.0, 232.0, 204.6, 223.8, 225.6, 203.8, 193.8, 183.0, 213.0, 178.8, 179.8, 186.0, 218.2, 254.0, 217.4, 203.8, 177.2, 232.2, 215.6, 195.0, 229.8, 252.0, 205.8, 189.2, 183.6, 221.8, 229.6, 171.6, 184.0, 194.6, 233.6]]

average6 = [[0.0, 1554.4, 2414.2, 3245.0, 4497.4, 5282.0, 6363.4, 7380.8, 8515.0, 9430.2, 10491.2, 11358.2, 12433.8, 13651.4, 14351.8, 15244.0, 16520.4, 17341.8, 18229.4, 19415.2, 20350.8, 21358.2, 22601.2, 23423.4, 24476.6, 25565.4, 26653.6, 27601.4, 28328.8, 29512.8, 30335.2, 31618.6, 32677.8, 33383.8, 34297.2, 35463.6, 36406.6, 37560.2, 38696.8, 39504.2, 40548.2, 41600.2, 42463.2, 43449.2, 44630.8, 45643.2, 46268.8, 47611.0, 48829.2, 49423.8, 50657.2, 51493.2, 52493.6, 53634.8, 54462.2, 55583.0, 56450.6, 57780.8, 58367.4, 59596.6, 60424.2, 61348.2, 62364.4, 63537.0, 64493.8, 65499.8, 66346.8, 67555.2, 68503.2, 69417.4, 70668.6, 71380.4, 72447.4, 73483.2, 74511.2, 75387.4, 76506.6, 77487.4, 78284.8, 79274.6, 80346.2, 81458.6, 82493.4, 83864.4, 84279.0, 85657.6, 86573.0, 87213.8, 88443.4, 89416.8, 90458.4, 91516.2, 92386.4, 93437.6, 94522.8, 95525.4, 96558.4, 97402.8, 98483.4], [0.0, 1164.4, 2189.2, 3167.2, 4191.6, 5640.6, 6528.2, 7292.0, 8359.0, 9407.8, 10175.2, 11264.6, 12442.4, 13594.8, 14312.4, 15606.2, 16513.4, 17509.8, 18446.8, 19606.6, 20449.0, 21649.6, 22305.0, 23692.0, 24428.6, 25506.2, 26429.2, 27328.2, 28441.6, 29496.4, 30553.6, 31291.4, 32508.4, 33269.8, 34421.2, 35491.0, 36514.8, 37735.0, 38440.0, 39570.0, 40242.0, 41608.4, 42660.4, 43387.6, 44229.6, 45550.4, 46305.4, 47417.6, 48553.8, 49768.0, 50653.8, 51505.8, 52417.0, 53348.4, 54586.2, 55396.2, 56711.4, 57558.0, 58326.0, 59440.2, 60533.6, 61609.6, 62382.2, 63561.4, 64528.6, 65505.8, 66599.4, 67530.4, 68524.2, 69313.8, 70602.0, 71615.8, 72317.8, 73360.6, 74333.0, 75413.2, 76549.4, 77664.4, 78566.0, 79612.8, 80526.0, 81449.8, 82603.4, 83275.4, 84712.0, 85632.2, 86169.2, 87643.8, 88206.8, 89553.0, 90497.2, 91537.8, 92805.6, 93490.0, 94663.8, 95497.4, 96588.2, 97374.0, 98445.2], [0.0, 1466.8, 2374.4, 3144.8, 4654.2, 5489.6, 6613.6, 7372.0, 8413.2, 9413.8, 10733.0, 11303.8, 12294.4, 13557.0, 14418.2, 15352.0, 16423.0, 17101.6, 18532.0, 19561.8, 20136.0, 21410.8, 22521.0, 23467.8, 24521.2, 25357.8, 26337.2, 27584.4, 28607.8, 29446.8, 30370.2, 31441.8, 32623.8, 33227.4, 34393.8, 35380.6, 36385.0, 37528.4, 38624.2, 39599.2, 40287.4, 41583.4, 42608.0, 43516.2, 44609.4, 45454.6, 46433.8, 47489.2, 48564.6, 49413.6, 50714.6, 51593.2, 52531.6, 53466.6, 54518.0, 55405.8, 56381.0, 57435.0, 58692.4, 59272.0, 60323.6, 61432.6, 62435.0, 63382.2, 64706.2, 65565.2, 66380.4, 67569.8, 68558.4, 69456.8, 70432.8, 71388.6, 72661.4, 73489.4, 74764.0, 75598.0, 76586.2, 77611.8, 78584.8, 79379.4, 80289.6, 81574.2, 82423.6, 83581.8, 84402.2, 85520.6, 86479.8, 87395.4, 88488.0, 89392.6, 90638.4, 91534.2, 92305.8, 93426.6, 94578.6, 95562.0, 96501.4, 97457.0, 98217.8], [0.0, 1252.2, 2350.2, 3130.0, 4556.4, 5372.4, 6380.0, 7447.6, 8413.2, 9431.8, 10517.0, 11449.0, 12438.2, 13427.4, 14287.6, 15358.2, 16476.4, 17294.0, 18301.4, 19355.8, 20598.2, 21579.0, 22603.0, 23369.6, 24260.2, 25193.2, 26446.4, 27501.4, 28653.6, 29602.6, 30662.2, 31648.0, 32625.0, 33407.2, 34396.6, 35743.6, 36488.6, 37411.4, 38504.4, 39343.6, 40384.4, 41397.0, 42502.2, 43271.4, 44535.6, 45700.6, 46445.6, 47382.2, 48485.6, 49548.0, 50356.2, 51438.0, 52228.6, 53478.2, 54281.4, 55371.0, 56722.4, 57384.8, 58340.2, 59732.2, 60536.6, 61637.8, 62344.6, 63391.2, 64460.8, 65376.0, 66595.6, 67659.8, 68658.6, 69571.2, 70728.6, 71701.6, 72439.8, 73560.2, 74700.2, 75450.4, 76430.4, 77387.8, 78622.2, 79528.4, 80233.4, 81587.0, 82283.2, 83432.2, 84183.0, 85617.4, 86435.0, 87409.4, 88818.8, 89446.8, 90488.4, 91574.4, 92343.8, 93456.2, 94442.0, 95528.0, 96466.6, 97489.0, 98644.2], [0.0, 1239.0, 2208.0, 3328.8, 4559.6, 5488.0, 6377.2, 7326.0, 8390.6, 9566.0, 10283.8, 11426.8, 12489.2, 13279.6, 14318.6, 15515.6, 16316.6, 17487.0, 18437.8, 19387.6, 20412.0, 21762.6, 22411.4, 23576.6, 24147.4, 25758.0, 26393.2, 27255.2, 28653.2, 29305.2, 30389.6, 31507.6, 32669.6, 33331.8, 34557.4, 35287.0, 36575.4, 37297.2, 38412.6, 39418.2, 40624.2, 41409.0, 42572.0, 43694.2, 44823.4, 45379.6, 46677.6, 47306.4, 48532.4, 49419.0, 50486.0, 51369.4, 52441.8, 53429.2, 54453.6, 55418.6, 56395.4, 57404.8, 58405.6, 59553.8, 60480.8, 61625.4, 62697.8, 63552.4, 64494.0, 65591.8, 66511.8, 67630.8, 68465.2, 69579.6, 70725.0, 71491.6, 72454.2, 73271.2, 74507.4, 75537.4, 76662.8, 77649.4, 78487.0, 79508.6, 80432.6, 81642.8, 82549.4, 83387.2, 84356.0, 85409.2, 86333.8, 87374.6, 88578.6, 89470.8, 90572.8, 91640.4, 92425.8, 93572.0, 94481.8, 95826.6, 96196.0, 97693.6, 98574.8], [0.0, 1253.6, 2187.8, 3380.0, 4405.4, 5403.0, 6749.6, 7424.8, 8482.2, 9394.4, 10360.2, 11290.2, 12401.2, 13656.2, 14210.8, 15355.6, 16371.8, 17403.8, 18554.4, 19460.4, 20515.4, 21405.2, 22496.0, 23484.4, 24574.0, 25459.2, 26760.8, 27354.6, 28613.6, 29357.4, 30575.0, 31492.6, 32592.6, 33554.4, 34511.8, 35310.4, 36361.4, 37356.4, 38581.6, 39649.6, 40637.2, 41359.0, 42563.8, 43318.6, 44595.0, 45540.2, 46469.8, 47524.4, 48377.6, 49441.0, 50582.8, 51592.0, 52700.8, 53280.4, 54733.2, 55691.8, 56514.0, 57460.4, 58598.6, 59334.0, 60489.8, 61553.0, 62404.2, 63681.6, 64770.4, 65556.4, 66565.4, 67604.2, 68502.8, 69498.8, 70630.6, 71819.4, 72502.4, 73589.0, 74539.2, 75482.6, 76496.0, 77328.0, 78559.8, 79569.2, 80491.0, 81490.2, 82487.8, 83280.0, 84637.2, 85444.4, 86486.0, 87418.8, 88792.2, 89422.2, 90560.6, 91312.4, 92593.8, 93580.0, 94608.0, 95522.6, 96635.2, 97789.2, 98347.8]]

#plt.plot(np.arange(0, 99000, 1000), average[0])

def input_function(x, a, b):
    return b*np.exp(-1 * a * np.array(x))

for t in final_colour:
    final_sum = 0
    print(t)
    for z in range (1, 6):
        h = read_file('./Physics2/'+t+str(z)+'.wav', 1000, 100000, 'r', "+")[0]
        hpos = read_file('./Physics2/'+t+str(z)+'.wav', 1000, 100000, 'r', "+")[1]
        b = h[0]
        params, params_covariance = optimize.curve_fit(lambda x, a: input_function(x, a, b), hpos, h, [0.0005])
        final_sum = final_sum + params[0]
        print(params[0])
    print(final_sum/5)




'''
for h in range(0, len(average)):
    params, params_covariance = optimize.curve_fit(input_function, np.arange(0, 99000, 1000), average[h])
    print(final_colour[h]+": "+str(params))
'''
'''

def input_function2(x, a, b):
    return -500*np.exp(-1 * a * (x + b))
'''
'''
for h in range(0, len(average2)):
    params, params_covariance = optimize.curve_fit(input_function2, np.arange(0, 99000, 1000), average2[h])
    print(final_colour[h]+": "+str(params))
'''

#params, params_covariance = optimize.curve_fit(input_function, average6[1], average5[1], [0.0002])

'''
plt.plot(average6[1], input_function(average6[1], params[0]),
         label='Fitted function', zorder=5)
'''

#read_file('./Physics/black1.wav', 2000, 100000, 'r', "+")

#print(params[0])

'''
for k in range (0, len(average3)):
    plt.plot(average4[k], average3[k])
'''

'''

plt.ylabel("Amplitude (dB)")
plt.xlabel("Time (Frames)")
plt.title("Sample Sound Waveform")
plt.show()



for h in average5[5]:
    print(h)

print(" ")
print(" ")

for v in average6[5]:
    print(v)
'''




'''
brass = (read_file('./Physics/brass1.wav', 100, 100000, 'r', "+")+read_file('./Physics/brass2.wav', 100, 100000, 'r', "+")+read_file('./Physics/brass3.wav', 100, 100000, 'r', "+")+read_file('./Physics/brass4.wav', 100, 100000, 'r', "+")+read_file('./Physics/brass5.wav', 100, 100000, 'r', "+"))/5
red = (read_file('./Physics/red1.wav', 100, 100000, 'r', "+")+read_file('./Physics/red2.wav', 100, 100000, 'r', "+")+read_file('./Physics/red3.wav', 100, 100000, 'r', "+")+read_file('./Physics/red4.wav', 100, 100000, 'r', "+")+read_file('./Physics/red5.wav', 100, 100000, 'r', "+")+read_file('./Physics/red6.wav', 100, 100000, 'r', "+"))/6
black = (read_file('./Physics/black1.wav', 100, 100000, 'r', "+")+read_file('./Physics/black2.wav', 100, 100000, 'r', "+")+read_file('./Physics/black3.wav', 100, 100000, 'r', "+")+read_file('./Physics/black4.wav', 100, 100000, 'r', "+")+read_file('./Physics/black5.wav', 100, 100000, 'r', "+")+read_file('./Physics/black6.wav', 100, 100000, 'r', "+"))/6
green = (read_file('./Physics/green1.wav', 100, 100000, 'r', "+")+read_file('./Physics/green2.wav', 100, 100000, 'r', "+")+read_file('./Physics/green3.wav', 100, 100000, 'r', "+")+read_file('./Physics/green4.wav', 100, 100000, 'r', "+")+read_file('./Physics/green5.wav', 100, 100000, 'r', "+")+read_file('./Physics/green6.wav', 100, 100000, 'r', "+"))/6
purple = (read_file('./Physics/purple1.wav', 100, 100000, 'r', "+")+read_file('./Physics/purple2.wav', 100, 100000, 'r', "+")+read_file('./Physics/purple3.wav', 100, 100000, 'r', "+")+read_file('./Physics/purple4.wav', 100, 100000, 'r', "+")+read_file('./Physics/purple5.wav', 100, 100000, 'r', "+")+read_file('./Physics/purple6.wav', 100, 100000, 'r', "+"))/6
silver = (read_file('./Physics/silver1.wav', 100, 100000, 'r', "+")+read_file('./Physics/silver2.wav', 100, 100000, 'r', "+")+read_file('./Physics/silver3.wav', 100, 100000, 'r', "+")+read_file('./Physics/silver4.wav', 100, 100000, 'r', "+")+read_file('./Physics/silver5.wav', 100, 100000, 'r', "+")+read_file('./Physics/silver6.wav', 100, 100000, 'r', "+"))/6
'''
'''
decay = []
for x in average:
    for m in x:
        if (m < 0.05*x[0]):
            decay.append(x.index(m))
            break;

print(decay)
'''
